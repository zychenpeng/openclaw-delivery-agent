# Phase 1 åŸ·è¡Œè¨ˆç•« - Scraper é‡æ§‹ + Brain Layer

**é–‹å§‹æ—¥æœŸ**ï¼š2026-02-22  
**é è¨ˆå®Œæˆ**ï¼šWeek 1-2  
**ç‹€æ…‹**ï¼šé€²è¡Œä¸­

---

## ç•¶å‰é€²åº¦ï¼ˆ2026-02-22 04:20ï¼‰

### âœ… å·²å®Œæˆ

**ç›®éŒ„çµæ§‹**
```
agent/
â”œâ”€â”€ scrapers/
â”‚   â”œâ”€â”€ browser_manager.py     # ç€è¦½å™¨ç®¡ç† âœ…
â”‚   â””â”€â”€ ubereats/
â”‚       â”œâ”€â”€ search.py          # æœå°‹åŠŸèƒ½ âœ…
â”‚       â””â”€â”€ menu.py            # èœå–®æŠ“å– âœ…
â”œâ”€â”€ planner/                   # å¾…å»ºç«‹
â”œâ”€â”€ data/                      # å¾…å»ºç«‹
â””â”€â”€ interfaces/line_bot/       # å¾…å»ºç«‹
```

**Scraper æ¨¡çµ„åŒ–**
- âœ… `BrowserManager` - Context manager ç®¡ç†ç€è¦½å™¨
- âœ… `UberEatsSearcher` - æœå°‹åŠŸèƒ½
  - å»é‡é‚è¼¯ï¼ˆæ ¹æ“šåº—å + URLï¼‰
  - URL æŠ“å–ï¼ˆå·²å„ªåŒ– 3 ç¨® fallback ç­–ç•¥ï¼‰
  - çµæ§‹åŒ–è¼¸å‡º
- âœ… `UberEatsMenuScraper` - èœå–®æŠ“å–
  - èœå–®é …ç›®å»é‡
  - è²»ç”¨æŠ“å–ï¼ˆé‹è²»ã€æœå‹™è²»ã€æœ€ä½æ¶ˆè²»ï¼‰

**æ¸¬è©¦å·¥å…·**
- âœ… `test_refactored_scraper.py` - æ•´åˆæ¸¬è©¦
- âœ… `debug_search_structure.py` - DOM çµæ§‹åˆ†æï¼ˆdebug ç”¨ï¼‰

### ğŸ”§ æœ€è¿‘å„ªåŒ–ï¼ˆå‰›å®Œæˆï¼‰

**URL æŠ“å–æ”¹å–„**
- æ–°å¢ 3 ç¨® fallback ç­–ç•¥
  1. æª¢æŸ¥å¡ç‰‡æœ¬èº«æ˜¯å¦ç‚º `<a>` æ¨™ç±¤
  2. æ‰¾å¡ç‰‡å…§ç¬¬ä¸€å€‹åŒ…å« `/store/` çš„é€£çµ
  3. éæ­·æ‰€æœ‰å…§éƒ¨é€£çµ
- æ–°å¢ `_normalize_url()` è¼”åŠ©å‡½æ•¸

---

## æ¥ä¸‹ä¾†è¦åš

### Week 1 å‰©é¤˜ä»»å‹™

#### Day 1-2: Scraper æœ€çµ‚é©—è­‰ï¼ˆä»Šå¤©å¯å®Œæˆï¼‰

**ä»»å‹™**
- [ ] åŸ·è¡Œå®Œæ•´æ¸¬è©¦é©—è­‰ URL æŠ“å–
- [ ] ç¢ºèªè²»ç”¨è³‡è¨ŠæŠ“å–å®Œæ•´æ€§
- [ ] è™•ç† edge casesï¼ˆåº—å®¶æš«åœç‡Ÿæ¥­ã€ç¼ºè²¨ç­‰ï¼‰

**é æœŸè¼¸å‡º**
- æœå°‹çµæœ JSON å«å®Œæ•´ URL
- åº—å®¶è³‡è¨Šå«é‹è²»ã€æœå‹™è²»ã€æœ€ä½æ¶ˆè²»
- æ¸¬è©¦é€šéç‡ > 90%

#### Day 3-4: Brain Layer é–‹ç™¼

**1. Intent Parserï¼ˆéœ€æ±‚è§£æï¼‰**

è¼¸å…¥ï¼š
```
ã€Œå®µå¤œ 300 å…§ è¦è¾£ 30 åˆ†é˜ã€
```

è¼¸å‡ºï¼š
```json
{
  "meal_type": "å®µå¤œ",
  "budget_max": 300,
  "preferences": ["è¾£"],
  "eta_max": 30,
  "dietary_restrictions": []
}
```

å¯¦ä½œï¼š
- ä½¿ç”¨ LLMï¼ˆOpenAI / Claude / Local modelï¼‰
- Prompt engineering æå–çµæ§‹åŒ–è³‡è¨Š
- Fallback è¦å‰‡ï¼ˆé ç®—ã€ETA çš„æ­£å‰‡è¡¨é”å¼ï¼‰

**2. Scoring Engineï¼ˆè©•åˆ†å¼•æ“ï¼‰**

è©•åˆ†å› ç´ ï¼š
```yaml
weights:
  price_score: 0.25      # é ä¼°ç¸½åƒ¹ï¼ˆå«é‹è²»ï¼‰
  eta_score: 0.25        # é ä¼°åˆ°é”æ™‚é–“
  rating_score: 0.20     # åº—å®¶è©•åˆ†
  preference_match: 0.20 # ç¬¦åˆç”¨æˆ¶éœ€æ±‚
  popularity: 0.10       # è©•è«–æ•¸
```

å¯¦ä½œï¼š
- æ¯é …å› ç´ æ¨™æº–åŒ–åˆ° 0-1
- åŠ æ¬Šè¨ˆç®—ç¸½åˆ†
- æ’åºä¸¦å›å‚³ Top N

**3. Recommendation Generatorï¼ˆæ¨è–¦ç†ç”±ï¼‰**

ç¯„ä¾‹è¼¸å‡ºï¼š
```
ğŸ¥‡ å·å‘³éº»è¾£
   æ¨è–¦ç†ç”±ï¼šé«˜è©•åˆ† + å¿«é€Ÿåˆ°é” + ç¬¦åˆè¾£å‘³éœ€æ±‚
```

å¯¦ä½œï¼š
- æ ¹æ“šè©•åˆ†å› ç´ ç”Ÿæˆè‡ªç„¶èªè¨€
- Template-based æˆ– LLM ç”Ÿæˆ

#### Day 5: æ•´åˆæ¸¬è©¦

**å®Œæ•´æµç¨‹æ¸¬è©¦**
```
è¼¸å…¥éœ€æ±‚
  â†“
Intent Parser
  â†“
Search (æœå°‹å€™é¸åº—å®¶)
  â†“
Scoring Engine
  â†“
Top 3 æ¨è–¦ï¼ˆå«ç†ç”±ï¼‰
  â†“
JSON è¼¸å‡º
```

**æ¸¬è©¦æ¡ˆä¾‹**
1. ã€Œåˆé¤ 150 å…§ æ¸…æ·¡ã€
2. ã€Œå®µå¤œ 300 è¦è¾£ å¿«ä¸€é»ã€
3. ã€Œæ—©é¤ ç´ é£Ÿ 100 å…§ã€

---

## Week 2 è¨ˆç•«ï¼ˆç°¡è¦ï¼‰

### Day 1-3: LINE Bot é–‹ç™¼
- LINE Messaging API ä¸²æ¥
- Flex Message å¡ç‰‡è¨­è¨ˆ
- å°è©±æµç¨‹å¯¦ä½œ

### Day 4-5: é–‹æºæº–å‚™
- README.md æ’°å¯«
- Demo GIF éŒ„è£½
- GitHub ç™¼å¸ƒ

---

## æŠ€è¡“æ£§

### å·²ç¢ºå®š
- **ç€è¦½å™¨è‡ªå‹•åŒ–**ï¼šPlaywright
- **è³‡æ–™è™•ç†**ï¼šPython 3.x
- **è¼¸å‡ºæ ¼å¼**ï¼šJSON

### å¾…æ±ºå®š
- **LLM**ï¼šOpenAI GPT / Claude / Ollama (local)
- **å¿«å–**ï¼šRedis / SQLite / æª”æ¡ˆç³»çµ±
- **LINE Bot**ï¼šFlask / FastAPI
- **éƒ¨ç½²**ï¼šDocker / Railway / Render

---

## ç›®å‰æª”æ¡ˆæ¸…å–®

```
openclaw-delivery-agent/
â”œâ”€â”€ PHASE_0_REPORT.md            # Phase 0 å ±å‘Š âœ…
â”œâ”€â”€ PHASE_1_PLAN.md              # æœ¬æ–‡ä»¶ âœ…
â”œâ”€â”€ delivery-agent-v2-plan.md    # v2.0 å®Œæ•´è¨ˆç•« âœ…
â”œâ”€â”€ chromium_profile/            # ç€è¦½å™¨ profile âœ…
â”œâ”€â”€ results/                     # æ¸¬è©¦çµæœèˆ‡æˆªåœ– âœ…
â”œâ”€â”€ agent/
â”‚   â””â”€â”€ scrapers/
â”‚       â”œâ”€â”€ browser_manager.py   âœ…
â”‚       â””â”€â”€ ubereats/
â”‚           â”œâ”€â”€ search.py        âœ… (å‰›å„ªåŒ–)
â”‚           â””â”€â”€ menu.py          âœ…
â”œâ”€â”€ test_refactored_scraper.py   âœ…
â””â”€â”€ debug_search_structure.py    âœ…
```

---

## ä¸‹ä¸€æ­¥è¡Œå‹•

### ç«‹å³å¯åšï¼ˆä»Šå¤©ï¼‰
1. **åŸ·è¡Œæ¸¬è©¦é©—è­‰** URL æŠ“å–æ”¹å–„
   ```bash
   python test_refactored_scraper.py
   ```

2. **é–‹å§‹ Brain Layer** è¨­è¨ˆ
   - å»ºç«‹ `agent/planner/intent_parser.py`
   - å»ºç«‹ `agent/planner/scorer.py`
   - å»ºç«‹ `agent/planner/recommender.py`

### æ˜å¤©é–‹å§‹
3. **Intent Parser å¯¦ä½œ** - æ¥ LLM è§£æéœ€æ±‚
4. **Scoring Engine å¯¦ä½œ** - å¤šå› ç´ è©•åˆ†
5. **æ•´åˆæ¸¬è©¦** - å®Œæ•´æµç¨‹é©—è­‰

---

## å•é¡Œè¿½è¹¤

### å·²è§£æ±º
- âœ… æœå°‹çµæœé‡è¤‡ï¼ˆå·²åŠ å»é‡ï¼‰
- âœ… URL æŠ“å–å¤±æ•—ï¼ˆå·²å„ªåŒ– 3 ç¨®ç­–ç•¥ï¼‰
- âœ… èœå–®é …ç›®é‡è¤‡ï¼ˆå·²åŠ å»é‡ï¼‰

### å¾…è§£æ±º
- âš ï¸ è©•è«–æ•¸è§£æï¼ˆæ ¼å¼å¤šæ¨£ï¼Œéœ€æ”¹å–„ï¼‰
- âš ï¸ è²»ç”¨è³‡è¨Šä¸ç©©å®šï¼ˆselector éœ€åŠ å¼·ï¼‰
- âš ï¸ Edge cases è™•ç†ï¼ˆç¼ºè²¨ã€æš«åœç‡Ÿæ¥­ï¼‰

### å¾…æ¸¬è©¦
- ğŸ” å®Œæ•´æµç¨‹æ¸¬è©¦
- ğŸ” å¤šé—œéµå­—æ¸¬è©¦
- ğŸ” éŒ¯èª¤è™•ç†æ¸¬è©¦

---

**æ›´æ–°æ™‚é–“**ï¼š2026-02-22 04:20  
**ä¸‹æ¬¡æ›´æ–°**ï¼šå®Œæˆ Brain Layer å¾Œ
